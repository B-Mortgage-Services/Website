{{ define "main" }}

<style>
/* Wellness Check Specific Styles */
.wellness-hero {
  background: linear-gradient(135deg, var(--color-cream) 0%, var(--color-peach) 100%);
  padding: calc(80px + var(--space-3xl)) 0 var(--space-3xl);
}

.wellness-form-container {
  max-width: 800px;
  margin: 0 auto;
}

.wellness-progress {
  display: flex;
  justify-content: space-between;
  margin-bottom: var(--space-2xl);
  position: relative;
}

.wellness-progress::before {
  content: '';
  position: absolute;
  top: 20px;
  left: 5%;
  right: 5%;
  height: 3px;
  background: var(--color-gray-200);
  z-index: 0;
}

.wellness-progress__step {
  text-align: center;
  position: relative;
  z-index: 1;
  flex: 1;
}

.wellness-progress__number {
  width: 40px;
  height: 40px;
  background: var(--color-white);
  border: 3px solid var(--color-gray-200);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto var(--space-sm);
  font-weight: 600;
  color: var(--color-gray-500);
  transition: all var(--transition-normal);
}

.wellness-progress__step.active .wellness-progress__number {
  border-color: var(--color-primary);
  background: var(--color-primary);
  color: var(--color-white);
}

.wellness-progress__step.completed .wellness-progress__number {
  border-color: var(--color-success);
  background: var(--color-success);
  color: var(--color-white);
}

.wellness-progress__label {
  font-size: 0.8125rem;
  color: var(--color-gray-500);
}

.wellness-progress__step.active .wellness-progress__label {
  color: var(--color-secondary);
  font-weight: 500;
}

.form-card {
  background: var(--color-white);
  border-radius: var(--radius-xl);
  padding: var(--space-2xl);
  box-shadow: var(--shadow-lg);
}

.form-section {
  display: none;
}

.form-section.active {
  display: block;
  animation: fadeInUp 0.4s ease-out;
}

.form-section__title {
  font-size: 1.5rem;
  margin-bottom: var(--space-sm);
}

.form-section__desc {
  color: var(--color-gray-500);
  margin-bottom: var(--space-xl);
}

.form-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-lg);
}

@media (max-width: 640px) {
  .form-row {
    grid-template-columns: 1fr;
  }
}

.radio-group {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-md);
}

.radio-option {
  flex: 1;
  min-width: 140px;
}

.radio-option input {
  display: none;
}

.radio-option label {
  display: block;
  padding: var(--space-lg);
  background: var(--color-gray-100);
  border: 2px solid transparent;
  border-radius: var(--radius-md);
  text-align: center;
  cursor: pointer;
  transition: all var(--transition-fast);
}

.radio-option input:checked + label {
  background: var(--color-cream);
  border-color: var(--color-primary);
}

.radio-option label:hover {
  background: var(--color-peach);
}

.slider-group {
  padding: var(--space-md) 0;
}

.slider-labels {
  display: flex;
  justify-content: space-between;
  margin-bottom: var(--space-sm);
}

.slider-value {
  font-family: var(--font-display);
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--color-primary);
  text-align: center;
  margin-bottom: var(--space-md);
}

input[type="range"] {
  width: 100%;
  height: 8px;
  background: var(--color-gray-200);
  border-radius: 4px;
  outline: none;
  -webkit-appearance: none;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 24px;
  height: 24px;
  background: var(--color-primary);
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 2px 6px rgba(240, 91, 40, 0.3);
}

.form-nav {
  display: flex;
  justify-content: space-between;
  margin-top: var(--space-2xl);
  padding-top: var(--space-xl);
  border-top: 1px solid var(--color-gray-200);
}

/* Results Styles */
.results-container {
  display: none;
}

.results-container.active {
  display: block;
}

.results-header {
  text-align: center;
  padding: var(--space-2xl);
  background: linear-gradient(135deg, var(--color-cream), var(--color-peach));
  border-radius: var(--radius-xl) var(--radius-xl) 0 0;
}

/* Semi-circular Gauge - matches mockup */
.score-gauge-wrapper {
  position: relative;
  width: 220px;
  height: 130px;
  margin: var(--space-xl) auto var(--space-md);
}

.score-gauge-svg {
  width: 100%;
  height: 100%;
  overflow: visible;
}

.score-gauge-bg {
  fill: none;
  stroke: var(--color-gray-200);
  stroke-width: 20;
  stroke-linecap: round;
}

.score-gauge-fill {
  fill: none;
  stroke-width: 20;
  stroke-linecap: round;
  transition: stroke-dashoffset 1s ease-out, stroke 0.3s ease;
}

.score-gauge-value {
  position: absolute;
  bottom: 5px;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
}

.score-gauge-value__number {
  font-family: var(--font-display);
  font-size: 3.5rem;
  font-weight: 700;
  color: var(--color-secondary);
  line-height: 1;
}

.score-gauge-value__max {
  font-size: 1.25rem;
  color: var(--color-gray-500);
}

.score-gauge-label {
  font-size: 1rem;
  font-weight: 600;
  margin-top: var(--space-xs);
}

.score-gauge-label--good { color: var(--color-success); }
.score-gauge-label--caution { color: var(--color-warning); }
.score-gauge-label--risk { color: #C0392B; }

.score-band {
  display: inline-block;
  padding: var(--space-sm) var(--space-lg);
  background: var(--color-success-light);
  color: var(--color-success);
  border-radius: var(--radius-full);
  font-weight: 600;
  margin-top: var(--space-md);
}

.score-band--good {
  background: var(--color-success-light);
  color: var(--color-success);
}

.score-band--caution {
  background: var(--color-warning-light);
  color: var(--color-warning);
}

.score-band--risk {
  background: var(--color-danger-light);
  color: var(--color-danger);
}

.results-body {
  padding: var(--space-2xl);
}

.pillar-scores {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: var(--space-lg);
  margin-bottom: var(--space-2xl);
}

@media (max-width: 768px) {
  .pillar-scores {
    grid-template-columns: repeat(2, 1fr);
  }
}

.pillar-score {
  text-align: center;
}

.pillar-score__bar {
  width: 100%;
  height: 8px;
  background: var(--color-gray-200);
  border-radius: 4px;
  margin-bottom: var(--space-sm);
  overflow: hidden;
}

.pillar-score__fill {
  height: 100%;
  background: var(--color-primary);
  border-radius: 4px;
  transition: width 1s ease-out;
}

.pillar-score__label {
  font-size: 0.8125rem;
  color: var(--color-gray-500);
}

.pillar-score__value {
  font-weight: 600;
  color: var(--color-secondary);
}

.results-section {
  margin-bottom: var(--space-2xl);
}

.results-section h3 {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  margin-bottom: var(--space-lg);
}

.results-section h3 svg {
  color: var(--color-success);
}

.results-section--improve h3 svg {
  color: var(--color-warning);
}

.action-card {
  background: var(--color-gray-100);
  border-radius: var(--radius-md);
  padding: var(--space-lg);
  margin-bottom: var(--space-md);
}

.action-card h4 {
  margin-bottom: var(--space-sm);
}

.action-card p {
  font-size: 0.9375rem;
  color: var(--color-gray-700);
  margin: 0;
}

.action-card__impact {
  font-size: 0.8125rem;
  color: var(--color-primary);
  font-weight: 500;
  margin-top: var(--space-sm);
}

.results-cta {
  background: var(--color-secondary);
  color: var(--color-white);
  border-radius: 0 0 var(--radius-xl) var(--radius-xl);
  padding: var(--space-2xl);
  text-align: center;
}

.results-cta h3 {
  color: var(--color-white);
  margin-bottom: var(--space-sm);
}

.results-cta p {
  color: rgba(255,255,255,0.8);
  margin-bottom: var(--space-xl);
}

.disclaimer-box {
  background: var(--color-gray-100);
  border-radius: var(--radius-md);
  padding: var(--space-lg);
  margin-top: var(--space-2xl);
  font-size: 0.8125rem;
  color: var(--color-gray-500);
}
</style>

<!-- Hero -->
<section class="wellness-hero">
  <div class="container">
    <div style="max-width: 700px; margin: 0 auto; text-align: center;">
      <h1>Check Your Mortgage & Financial Wellness</h1>
      <p style="font-size: 1.25rem; color: var(--color-gray-700);">
        Get a personalised report on your mortgage readiness, affordability, and financial resilience. Takes just 3 minutes.
      </p>
      <p style="color: var(--color-gray-500); margin-top: var(--space-md);">
        <svg width="16" height="16" fill="var(--color-success)" viewBox="0 0 24 24" style="vertical-align: middle;"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        No impact on your credit score • Completely confidential
      </p>
    </div>
  </div>
</section>

<!-- Form Section -->
<section class="section" style="margin-top: -var(--space-2xl);">
  <div class="container">
    <div class="wellness-form-container">
      
      <!-- Progress Bar -->
      <div class="wellness-progress" id="progressBar">
        <div class="wellness-progress__step active" data-step="1">
          <div class="wellness-progress__number">1</div>
          <div class="wellness-progress__label">Income</div>
        </div>
        <div class="wellness-progress__step" data-step="2">
          <div class="wellness-progress__number">2</div>
          <div class="wellness-progress__label">Property</div>
        </div>
        <div class="wellness-progress__step" data-step="3">
          <div class="wellness-progress__number">3</div>
          <div class="wellness-progress__label">Finances</div>
        </div>
        <div class="wellness-progress__step" data-step="4">
          <div class="wellness-progress__number">4</div>
          <div class="wellness-progress__label">Protection</div>
        </div>
      </div>

      <!-- Form -->
      <form id="wellnessForm" class="form-card">
        
        <!-- Section 1: Income -->
        <div class="form-section active" data-section="1">
          <h2 class="form-section__title">Let's start with your income</h2>
          <p class="form-section__desc">This helps us understand your mortgage eligibility.</p>
          
          <div class="form-group">
            <label class="form-label">What is your employment status?</label>
            <div class="radio-group">
              <div class="radio-option">
                <input type="radio" name="employment" id="emp-paye" value="paye-long" checked>
                <label for="emp-paye">PAYE (12+ months)</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="employment" id="emp-paye-new" value="paye-new">
                <label for="emp-paye-new">PAYE (&lt;12 months)</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="employment" id="emp-self" value="self-employed">
                <label for="emp-self">Self-employed</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="employment" id="emp-contract" value="contractor">
                <label for="emp-contract">Contractor</label>
              </div>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Your annual income (before tax)</label>
              <input type="number" class="form-input" name="income" value="50000" placeholder="£50,000">
            </div>
            <div class="form-group">
              <label class="form-label">Partner's income (if applicable)</label>
              <input type="number" class="form-input" name="income2" value="0" placeholder="£0">
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">How would you describe your credit history?</label>
            <div class="radio-group">
              <div class="radio-option">
                <input type="radio" name="credit" id="credit-clean" value="clean" checked>
                <label for="credit-clean">Clean (no issues)</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="credit" id="credit-minor" value="minor">
                <label for="credit-minor">Minor issues (past)</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="credit" id="credit-recent" value="recent">
                <label for="credit-recent">Recent issues</label>
              </div>
            </div>
          </div>
          
          <div class="form-nav">
            <div></div>
            <button type="button" class="btn btn--primary" onclick="nextSection()">
              Continue
              <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
            </button>
          </div>
        </div>

        <!-- Section 2: Property -->
        <div class="form-section" data-section="2">
          <h2 class="form-section__title">About the property</h2>
          <p class="form-section__desc">This helps calculate your loan-to-value ratio.</p>
          
          <div class="form-group">
            <label class="form-label">Estimated property value</label>
            <div class="slider-group">
              <div class="slider-value">£<span id="propertyValueDisplay">250,000</span></div>
              <input type="range" name="propertyValue" min="100000" max="1000000" step="10000" value="250000" oninput="updateSlider(this, 'propertyValueDisplay')">
              <div class="slider-labels">
                <span>£100k</span>
                <span>£1m</span>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Your deposit amount</label>
            <div class="slider-group">
              <div class="slider-value">£<span id="depositDisplay">25,000</span></div>
              <input type="range" name="deposit" min="5000" max="200000" step="5000" value="25000" oninput="updateSlider(this, 'depositDisplay')">
              <div class="slider-labels">
                <span>£5k</span>
                <span>£200k</span>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">What type of property are you looking at?</label>
            <div class="radio-group">
              <div class="radio-option">
                <input type="radio" name="propertyType" id="prop-first" value="first-time" checked>
                <label for="prop-first">First home</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="propertyType" id="prop-move" value="moving">
                <label for="prop-move">Moving home</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="propertyType" id="prop-remort" value="remortgage">
                <label for="prop-remort">Remortgage</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="propertyType" id="prop-btl" value="buy-to-let">
                <label for="prop-btl">Buy-to-let</label>
              </div>
            </div>
          </div>
          
          <div class="form-nav">
            <button type="button" class="btn btn--secondary" onclick="prevSection()">Back</button>
            <button type="button" class="btn btn--primary" onclick="nextSection()">
              Continue
              <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
            </button>
          </div>
        </div>

        <!-- Section 3: Budget & Resilience -->
        <div class="form-section" data-section="3">
          <h2 class="form-section__title">Your financial health</h2>
          <p class="form-section__desc">Understanding your budget and savings helps us assess affordability.</p>
          
          <div class="form-group">
            <label class="form-label">What % of your net income do you expect mortgage payments to be?</label>
            <div class="radio-group">
              <div class="radio-option">
                <input type="radio" name="mortgageRatio" id="ratio-low" value="low" checked>
                <label for="ratio-low">Under 30%</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="mortgageRatio" id="ratio-mid" value="mid">
                <label for="ratio-mid">30-40%</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="mortgageRatio" id="ratio-high" value="high">
                <label for="ratio-high">Over 40%</label>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">How much do you currently have in emergency savings?</label>
            <div class="radio-group">
              <div class="radio-option">
                <input type="radio" name="savings" id="sav-6" value="6-plus">
                <label for="sav-6">6+ months expenses</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="savings" id="sav-3" value="3-6" checked>
                <label for="sav-3">3-6 months</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="savings" id="sav-1" value="1-3">
                <label for="sav-1">1-3 months</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="savings" id="sav-0" value="under-1">
                <label for="sav-0">Less than 1 month</label>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Do you regularly save money each month?</label>
            <div class="radio-group">
              <div class="radio-option">
                <input type="radio" name="savingHabit" id="habit-yes" value="regular" checked>
                <label for="habit-yes">Yes, regularly</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="savingHabit" id="habit-sometimes" value="irregular">
                <label for="habit-sometimes">Sometimes</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="savingHabit" id="habit-no" value="none">
                <label for="habit-no">Not currently</label>
              </div>
            </div>
          </div>
          
          <div class="form-nav">
            <button type="button" class="btn btn--secondary" onclick="prevSection()">Back</button>
            <button type="button" class="btn btn--primary" onclick="nextSection()">
              Continue
              <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
            </button>
          </div>
        </div>

        <!-- Section 4: Protection -->
        <div class="form-section" data-section="4">
          <h2 class="form-section__title">Protecting your mortgage</h2>
          <p class="form-section__desc">A mortgage is a long-term commitment. Let's see how prepared you are.</p>
          
          <div class="form-group">
            <label class="form-label">Do you currently have life insurance?</label>
            <div class="radio-group">
              <div class="radio-option">
                <input type="radio" name="lifeInsurance" id="life-yes" value="yes">
                <label for="life-yes">Yes</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="lifeInsurance" id="life-partial" value="partial" checked>
                <label for="life-partial">Through work only</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="lifeInsurance" id="life-no" value="no">
                <label for="life-no">No</label>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Do you have income protection insurance?</label>
            <div class="radio-group">
              <div class="radio-option">
                <input type="radio" name="incomeProtection" id="income-yes" value="yes">
                <label for="income-yes">Yes</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="incomeProtection" id="income-partial" value="partial">
                <label for="income-partial">Some cover</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="incomeProtection" id="income-no" value="no" checked>
                <label for="income-no">No</label>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Do you have critical illness cover?</label>
            <div class="radio-group">
              <div class="radio-option">
                <input type="radio" name="criticalIllness" id="critical-yes" value="yes">
                <label for="critical-yes">Yes</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="criticalIllness" id="critical-partial" value="partial">
                <label for="critical-partial">Some cover</label>
              </div>
              <div class="radio-option">
                <input type="radio" name="criticalIllness" id="critical-no" value="no" checked>
                <label for="critical-no">No</label>
              </div>
            </div>
          </div>
          
          <div class="form-nav">
            <button type="button" class="btn btn--secondary" onclick="prevSection()">Back</button>
            <button type="button" class="btn btn--primary btn--large" onclick="calculateResults()">
              Get My Results
              <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
            </button>
          </div>
        </div>
      </form>

      <!-- Results -->
      <div class="results-container" id="resultsContainer">
        <div class="form-card" style="padding: 0; overflow: hidden;">
          <div class="results-header">
            <h2>Your Financial Wellness Report</h2>
            
            <!-- Semi-circular Gauge -->
            <div class="score-gauge-wrapper">
              <svg class="score-gauge-svg" viewBox="0 0 200 120">
                <!-- Background arc -->
                <path class="score-gauge-bg" d="M 20 100 A 80 80 0 0 1 180 100" />
                <!-- Colored fill arc - will be updated by JS -->
                <path class="score-gauge-fill" id="gaugeArc" d="M 20 100 A 80 80 0 0 1 180 100" 
                      stroke="url(#gaugeGradient)" 
                      stroke-dasharray="251.2" 
                      stroke-dashoffset="70" />
                <!-- Gradient definition -->
                <defs>
                  <linearGradient id="gaugeGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                    <stop offset="0%" style="stop-color:#C0392B" />
                    <stop offset="35%" style="stop-color:#F05B28" />
                    <stop offset="65%" style="stop-color:#D4A017" />
                    <stop offset="100%" style="stop-color:#2E7D5A" />
                  </linearGradient>
                </defs>
              </svg>
              <div class="score-gauge-value">
                <span class="score-gauge-value__number" id="totalScore">72</span>
                <span class="score-gauge-value__max">/100</span>
                <div class="score-gauge-label score-gauge-label--good" id="scoreLabel">Good</div>
              </div>
            </div>
            
            <div class="score-band" id="scoreBand">On Track – Minor Gaps</div>
            <p style="color: var(--color-gray-700); margin-top: var(--space-md);" id="scoreDescription">
              You're broadly on track for a mortgage, with some areas to improve.
            </p>
          </div>
          
          <div class="results-body">
            <div class="pillar-scores">
              <div class="pillar-score">
                <div class="pillar-score__bar"><div class="pillar-score__fill" id="eligibilityBar" style="width: 80%;"></div></div>
                <div class="pillar-score__value" id="eligibilityScore">28/35</div>
                <div class="pillar-score__label">Eligibility</div>
              </div>
              <div class="pillar-score">
                <div class="pillar-score__bar"><div class="pillar-score__fill" id="affordabilityBar" style="width: 73%;"></div></div>
                <div class="pillar-score__value" id="affordabilityScore">22/30</div>
                <div class="pillar-score__label">Affordability</div>
              </div>
              <div class="pillar-score">
                <div class="pillar-score__bar"><div class="pillar-score__fill" id="resilienceBar" style="width: 60%;"></div></div>
                <div class="pillar-score__value" id="resilienceScore">12/20</div>
                <div class="pillar-score__label">Resilience</div>
              </div>
              <div class="pillar-score">
                <div class="pillar-score__bar"><div class="pillar-score__fill" id="protectionBar" style="width: 67%;"></div></div>
                <div class="pillar-score__value" id="protectionScore">10/15</div>
                <div class="pillar-score__label">Protection</div>
              </div>
            </div>
            
            <div class="results-section">
              <h3>
                <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                Your Strengths
              </h3>
              <div id="strengthsList">
                <div class="wellness-card__tags">
                  <span class="wellness-tag wellness-tag--success">✓ Steady income</span>
                  <span class="wellness-tag wellness-tag--success">✓ Good budget control</span>
                  <span class="wellness-tag wellness-tag--success">✓ Clean credit history</span>
                </div>
              </div>
            </div>
            
            <div class="results-section results-section--improve">
              <h3>
                <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                Top Priority Actions
              </h3>
              <div id="actionsList">
                <div class="action-card">
                  <h4>Build emergency savings to cover 3 months of essential spending</h4>
                  <p>This improves financial resilience and reduces reliance on credit if circumstances change.</p>
                  <div class="action-card__impact">Impact: Strengthens resilience and affordability confidence</div>
                </div>
                <div class="action-card">
                  <h4>Consider income protection insurance</h4>
                  <p>This ensures your mortgage payments are covered if you're unable to work due to illness.</p>
                  <div class="action-card__impact">Impact: Protects your home and provides peace of mind</div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="results-cta">
            <h3>Ready to Take the Next Step?</h3>
            <p>This report is designed to help you understand your position. Let's discuss your options.</p>
            <div style="display: flex; justify-content: center; gap: var(--space-md); flex-wrap: wrap;">
              <a href="/contact/" class="btn btn--primary btn--large">Book a Free Consultation</a>
              <button type="button" class="btn btn--outline btn--large" style="border-color: white; color: white;" onclick="window.print()">Download Report</button>
            </div>
          </div>
        </div>
        
        <div class="disclaimer-box">
          <p><strong>Disclaimer:</strong> This assessment is based solely on the information you provided and does not guarantee mortgage acceptance. Individual lender criteria may vary. This report is designed to support informed conversations and does not constitute mortgage or financial advice.</p>
        </div>
      </div>

    </div>
  </div>
</section>

<script>
let currentSection = 1;
const totalSections = 4;

function updateProgress() {
  document.querySelectorAll('.wellness-progress__step').forEach((step, index) => {
    const stepNum = index + 1;
    step.classList.remove('active', 'completed');
    if (stepNum === currentSection) {
      step.classList.add('active');
    } else if (stepNum < currentSection) {
      step.classList.add('completed');
    }
  });
}

function showSection(sectionNum) {
  document.querySelectorAll('.form-section').forEach(section => {
    section.classList.remove('active');
  });
  document.querySelector(`[data-section="${sectionNum}"]`).classList.add('active');
  updateProgress();
}

function nextSection() {
  if (currentSection < totalSections) {
    currentSection++;
    showSection(currentSection);
    window.scrollTo({ top: 200, behavior: 'smooth' });
  }
}

function prevSection() {
  if (currentSection > 1) {
    currentSection--;
    showSection(currentSection);
    window.scrollTo({ top: 200, behavior: 'smooth' });
  }
}

function updateSlider(input, displayId) {
  const value = parseInt(input.value).toLocaleString('en-GB');
  document.getElementById(displayId).textContent = value;
}

function calculateResults() {
  // Get form values
  const form = document.getElementById('wellnessForm');
  const formData = new FormData(form);
  
  // Calculate scores based on the developer guide scoring framework
  let eligibilityScore = 0;
  let affordabilityScore = 0;
  let resilienceScore = 0;
  let protectionScore = 0;
  
  // Employment (15 points max)
  const employment = formData.get('employment');
  if (employment === 'paye-long') eligibilityScore += 15;
  else if (employment === 'paye-new') eligibilityScore += 12;
  else if (employment === 'self-employed') eligibilityScore += 10;
  else if (employment === 'contractor') eligibilityScore += 8;
  
  // Credit (10 points max)
  const credit = formData.get('credit');
  if (credit === 'clean') eligibilityScore += 10;
  else if (credit === 'minor') eligibilityScore += 7;
  else if (credit === 'recent') eligibilityScore += 3;
  
  // LTV calculation (10 points max)
  const propertyValue = parseFloat(formData.get('propertyValue')) || 250000;
  const deposit = parseFloat(formData.get('deposit')) || 25000;
  const ltv = ((propertyValue - deposit) / propertyValue) * 100;
  
  if (ltv <= 75) eligibilityScore += 10;
  else if (ltv <= 85) eligibilityScore += 8;
  else if (ltv <= 90) eligibilityScore += 6;
  else if (ltv <= 95) eligibilityScore += 3;
  
  // Mortgage ratio (10 points max)
  const ratio = formData.get('mortgageRatio');
  if (ratio === 'low') affordabilityScore += 10;
  else if (ratio === 'mid') affordabilityScore += 7;
  else if (ratio === 'high') affordabilityScore += 3;
  
  // Monthly surplus assumption (10 points)
  affordabilityScore += 7; // Assume break-even for now
  
  // Debt-to-income assumption (10 points)
  affordabilityScore += 8; // Assume moderate
  
  // Emergency savings (10 points max)
  const savings = formData.get('savings');
  if (savings === '6-plus') resilienceScore += 10;
  else if (savings === '3-6') resilienceScore += 7;
  else if (savings === '1-3') resilienceScore += 4;
  else if (savings === 'under-1') resilienceScore += 0;
  
  // Saving habit (5 points max)
  const savingHabit = formData.get('savingHabit');
  if (savingHabit === 'regular') resilienceScore += 5;
  else if (savingHabit === 'irregular') resilienceScore += 3;
  else resilienceScore += 0;
  
  // Future outlook assumption (5 points)
  resilienceScore += 4;
  
  // Protection scores (5 each)
  const life = formData.get('lifeInsurance');
  const income = formData.get('incomeProtection');
  const critical = formData.get('criticalIllness');
  
  if (life === 'yes') protectionScore += 5;
  else if (life === 'partial') protectionScore += 3;
  
  if (income === 'yes') protectionScore += 5;
  else if (income === 'partial') protectionScore += 3;
  
  if (critical === 'yes') protectionScore += 5;
  else if (critical === 'partial') protectionScore += 3;
  
  // Calculate total
  const totalScore = eligibilityScore + affordabilityScore + resilienceScore + protectionScore;
  
  // Update display
  document.getElementById('totalScore').textContent = totalScore;
  document.getElementById('eligibilityScore').textContent = `${eligibilityScore}/35`;
  document.getElementById('affordabilityScore').textContent = `${affordabilityScore}/30`;
  document.getElementById('resilienceScore').textContent = `${resilienceScore}/20`;
  document.getElementById('protectionScore').textContent = `${protectionScore}/15`;
  
  // Update bars
  document.getElementById('eligibilityBar').style.width = `${(eligibilityScore/35)*100}%`;
  document.getElementById('affordabilityBar').style.width = `${(affordabilityScore/30)*100}%`;
  document.getElementById('resilienceBar').style.width = `${(resilienceScore/20)*100}%`;
  document.getElementById('protectionBar').style.width = `${(protectionScore/15)*100}%`;
  
  // Update gauge arc - the arc length is 251.2 (half circle), so we calculate the offset
  const arcLength = 251.2;
  const fillAmount = (totalScore / 100) * arcLength;
  const offset = arcLength - fillAmount;
  document.getElementById('gaugeArc').style.strokeDashoffset = offset;
  
  // Update score label
  const scoreLabel = document.getElementById('scoreLabel');
  if (totalScore >= 80) {
    scoreLabel.textContent = 'Excellent';
    scoreLabel.className = 'score-gauge-label score-gauge-label--good';
  } else if (totalScore >= 65) {
    scoreLabel.textContent = 'Good';
    scoreLabel.className = 'score-gauge-label score-gauge-label--good';
  } else if (totalScore >= 50) {
    scoreLabel.textContent = 'Fair';
    scoreLabel.className = 'score-gauge-label score-gauge-label--caution';
  } else {
    scoreLabel.textContent = 'Needs Work';
    scoreLabel.className = 'score-gauge-label score-gauge-label--risk';
  }
  
  // Set band
  const scoreBand = document.getElementById('scoreBand');
  const scoreDesc = document.getElementById('scoreDescription');
  
  if (totalScore >= 80) {
    scoreBand.textContent = 'Mortgage-Ready & Financially Resilient';
    scoreBand.className = 'score-band score-band--good';
    scoreDesc.textContent = 'Based on the information you\'ve provided, you appear to be in a strong position to secure a suitable mortgage.';
  } else if (totalScore >= 65) {
    scoreBand.textContent = 'On Track – Minor Gaps';
    scoreBand.className = 'score-band score-band--good';
    scoreDesc.textContent = 'You appear to be broadly on track. There are a few areas where small improvements could strengthen your position.';
  } else if (totalScore >= 50) {
    scoreBand.textContent = 'Mortgage Possible with Planning';
    scoreBand.className = 'score-band score-band--caution';
    scoreDesc.textContent = 'A mortgage may be achievable, but careful planning will be important.';
  } else {
    scoreBand.textContent = 'Preparation Recommended';
    scoreBand.className = 'score-band score-band--risk';
    scoreDesc.textContent = 'Preparation is strongly recommended before committing to a mortgage.';
  }
  
  // Hide form, show results
  document.getElementById('wellnessForm').style.display = 'none';
  document.getElementById('resultsContainer').classList.add('active');
  document.getElementById('progressBar').style.display = 'none';
  
  window.scrollTo({ top: 0, behavior: 'smooth' });
}
</script>

{{ end }}
