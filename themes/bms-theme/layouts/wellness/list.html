{{ define "main" }}

<!-- Hero Section -->
<section class="wellness-hero" style="background-image: url('{{ "images/end-img.png" | relURL }}');">
  <div class="wellness-hero__overlay"></div>
  <div class="container">
    <div class="wellness-hero__content">
      <span class="hero__eyebrow hero__eyebrow--light">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
        </svg>
        Free Assessment
      </span>
      <h1>Check Your Mortgage &amp; Financial Wellness</h1>
      <p>Thinking about getting a mortgage? See how your finances look with our free Financial Wellness Report.</p>
      <div class="wellness-features wellness-features--light">
        <div class="wellness-feature">
          <svg class="wellness-feature__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          <span class="wellness-feature__text">Estimate your borrowing range</span>
        </div>
        <div class="wellness-feature">
          <svg class="wellness-feature__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          <span class="wellness-feature__text">Check your financial resilience</span>
        </div>
        <div class="wellness-feature">
          <svg class="wellness-feature__icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          <span class="wellness-feature__text">Identify top ways to strengthen your finances</span>
        </div>
      </div>
      <div class="wellness-cta wellness-cta--stacked" style="margin-top: 2rem;">
        <a href="#wellness-check" class="btn btn--primary btn--large">
          Start Your Free Check
          <svg class="btn__icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </a>
        <span class="wellness-cta__note">Takes just 3 minutes ‚Ä¢ No impact on your credit score</span>
      </div>
    </div>
  </div>
</section>

<!-- How It Works -->
<section class="process-section">
  <div class="container">
    <h2>How It Works</h2>
    <div class="process-steps">
      <div class="process-step">
        <div class="process-step__number">1</div>
        <h3 class="process-step__title">Answer Questions</h3>
        <p class="process-step__text">A short questionnaire about your income, savings, and financial situation.</p>
      </div>
      <div class="process-step">
        <div class="process-step__number">2</div>
        <h3 class="process-step__title">Get Your Score</h3>
        <p class="process-step__text">Receive an instant Financial Wellness Score based on four key pillars.</p>
      </div>
      <div class="process-step">
        <div class="process-step__number">3</div>
        <h3 class="process-step__title">See Your Report</h3>
        <p class="process-step__text">Get personalised insights and actionable steps to improve your position.</p>
      </div>
    </div>
  </div>
</section>

<!-- The Four Pillars -->
<section class="section--cream">
  <div class="container">
    <div class="text-center mb-5">
      <h2>What We Assess</h2>
      <p style="max-width: 700px; margin: 1rem auto 0; font-size: 1.1rem;">Your overall score is made up of four key areas. Each plays a different role in how lenders assess applications and how comfortable a mortgage feels in day-to-day life.</p>
    </div>
    
    <div class="services-grid">
      <article class="card">
        <div class="card__icon" style="background: rgba(34, 197, 94, 0.1); color: #22C55E;">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
        </div>
        <h3 class="card__title">Mortgage Eligibility</h3>
        <p class="card__text">How your income, deposit, and credit profile may be viewed by mortgage lenders.</p>
        <p style="font-size: 0.875rem; font-weight: 600; color: var(--brand-orange);">35% of your score</p>
      </article>
      
      <article class="card">
        <div class="card__icon" style="background: rgba(59, 130, 246, 0.1); color: #3B82F6;">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="1" x2="12" y2="23"/>
            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
          </svg>
        </div>
        <h3 class="card__title">Affordability &amp; Budget</h3>
        <p class="card__text">Not just how much you can borrow ‚Äî but what you can repay comfortably.</p>
        <p style="font-size: 0.875rem; font-weight: 600; color: var(--brand-orange);">30% of your score</p>
      </article>
      
      <article class="card">
        <div class="card__icon" style="background: rgba(245, 158, 11, 0.1); color: #F59E0B;">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
          </svg>
        </div>
        <h3 class="card__title">Financial Resilience</h3>
        <p class="card__text">How well you could cope with unexpected events.</p>
        <p style="font-size: 0.875rem; font-weight: 600; color: var(--brand-orange);">20% of your score</p>
      </article>
      
      <article class="card">
        <div class="card__icon" style="background: rgba(168, 85, 247, 0.1); color: #A855F7;">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/>
          </svg>
        </div>
        <h3 class="card__title">Protection Readiness</h3>
        <p class="card__text">Whether your mortgage would remain affordable if life doesn't go to plan.</p>
        <p style="font-size: 0.875rem; font-weight: 600; color: var(--brand-orange);">15% of your score</p>
      </article>
    </div>
  </div>
</section>

<!-- Interactive Wellness Check -->
<section class="section--white" id="wellness-check">
  <div class="container container--narrow">
    <div class="text-center mb-5">
      <h2>Start Your Financial Wellness Check</h2>
      <p>Answer a few questions to get your personalised report. Completely free with no impact on your credit score.</p>
    </div>
    
    <div class="calculator-box" style="max-width: 700px; margin: 0 auto;">
      <div style="display: flex; justify-content: center; gap: 0.5rem; margin-bottom: 2rem;">
        <div class="step-dot step-dot--active" data-step="1"></div>
        <div class="step-dot" data-step="2"></div>
        <div class="step-dot" data-step="3"></div>
        <div class="step-dot" data-step="4"></div>
        <div class="step-dot" data-step="5"></div>
      </div>
      
      <!-- Step 1 -->
      <div class="wellness-step" id="step-1">
        <h3 style="margin-bottom: 1.5rem;">Income &amp; Employment</h3>

        <!-- New: Age -->
        <div class="form-group">
          <label>Your age</label>
          <input type="number" id="user-age" min="18" max="70" placeholder="e.g. 35" style="padding: 0.75rem; border: 1px solid var(--medium-grey); border-radius: var(--radius-md); width: 100%; font-size: 1rem;">
        </div>

        <!-- New: Smoker status -->
        <div class="form-group">
          <label>Are you a smoker?</label>
          <div style="display: flex; gap: 1rem;">
            <label style="display: flex; align-items: center; cursor: pointer;">
              <input type="radio" name="smoker-status" id="smoker-yes" value="yes" style="margin-right: 0.5rem;">
              Yes
            </label>
            <label style="display: flex; align-items: center; cursor: pointer;">
              <input type="radio" name="smoker-status" id="smoker-no" value="no" checked style="margin-right: 0.5rem;">
              No
            </label>
          </div>
        </div>

        <div class="form-group">
          <label>What is your employment status?</label>
          <select id="employment-status">
            <option value="">Select...</option>
            <option value="paye-12">PAYE employed (12+ months)</option>
            <option value="paye-under">PAYE employed (under 12 months)</option>
            <option value="self-2">Self-employed (2+ years)</option>
            <option value="self-under">Self-employed (under 2 years)</option>
            <option value="contractor">Contractor</option>
            <option value="irregular">Irregular/variable income</option>
          </select>
        </div>

        <!-- New: Monthly take-home income -->
        <div class="form-group">
          <label>Your monthly take-home income (after tax) (¬£)</label>
          <input type="number" id="monthly-income" placeholder="e.g. 2,500" style="padding: 0.75rem; border: 1px solid var(--medium-grey); border-radius: var(--radius-md); width: 100%; font-size: 1rem;">
          <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem;">The amount that actually hits your bank account each month</p>
        </div>

        <!-- New: Partner question -->
        <div class="form-group">
          <label>Do you have a partner in a joint application?</label>
          <div style="display: flex; gap: 1rem;">
            <label style="display: flex; align-items: center; cursor: pointer;">
              <input type="radio" name="has-partner" id="partner-yes" value="yes" style="margin-right: 0.5rem;" onchange="togglePartnerIncome()">
              Yes
            </label>
            <label style="display: flex; align-items: center; cursor: pointer;">
              <input type="radio" name="has-partner" id="partner-no" value="no" checked style="margin-right: 0.5rem;" onchange="togglePartnerIncome()">
              No
            </label>
          </div>
        </div>

        <!-- Conditional: Partner income -->
        <div class="form-group" id="partner-income-group" style="display: none;">
          <label>Partner's monthly take-home income (¬£)</label>
          <input type="number" id="partner-income" placeholder="e.g. 2,000" style="padding: 0.75rem; border: 1px solid var(--medium-grey); border-radius: var(--radius-md); width: 100%; font-size: 1rem;">
        </div>

        <div class="form-group">
          <label>How would you describe your credit history?</label>
          <select id="credit-history">
            <option value="">Select...</option>
            <option value="clean">Clean - no issues</option>
            <option value="minor">Minor historic issues (3+ years ago)</option>
            <option value="recent">Some recent issues (last 3 years)</option>
            <option value="severe">Significant adverse credit</option>
          </select>
        </div>
        <button class="btn btn--primary" style="width: 100%; margin-top: 1rem;" onclick="nextStep(2)">Continue ‚Üí</button>
      </div>
      
      <!-- Step 2 -->
      <div class="wellness-step" id="step-2" style="display: none;">
        <h3 style="margin-bottom: 1.5rem;">Property &amp; Deposit</h3>
        <div class="form-group">
          <label>Approximate property value you're looking at (¬£)</label>
          <input type="number" id="property-value" placeholder="250,000">
        </div>
        <div class="form-group">
          <label>How much deposit do you have saved? (¬£)</label>
          <input type="number" id="deposit-amount" placeholder="25,000">
        </div>
        <div style="display: flex; gap: 1rem; margin-top: 1rem;">
          <button class="btn btn--secondary" style="flex: 1;" onclick="nextStep(1)">Back</button>
          <button class="btn btn--primary" style="flex: 1;" onclick="nextStep(3)">Continue ‚Üí</button>
        </div>
      </div>
      
      <!-- Step 3 -->
      <div class="wellness-step" id="step-3" style="display: none;">
        <h3 style="margin-bottom: 1.5rem;">Budget &amp; Savings</h3>

        <!-- New: Total accessible savings -->
        <div class="form-group">
          <label>Total accessible savings (¬£)</label>
          <input type="number" id="accessible-savings" placeholder="e.g. 5,000" style="padding: 0.75rem; border: 1px solid var(--medium-grey); border-radius: var(--radius-md); width: 100%; font-size: 1rem;">
          <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem;">Money you could get to within a week ‚Äî current accounts, easy-access savings, ISAs</p>
        </div>

        <!-- New: Essential monthly outgoings -->
        <div class="form-group">
          <label>Your essential monthly outgoings (¬£)</label>
          <input type="number" id="monthly-essentials" placeholder="e.g. 2,000" style="padding: 0.75rem; border: 1px solid var(--medium-grey); border-radius: var(--radius-md); width: 100%; font-size: 1rem;">
          <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem;">Mortgage/rent, bills, food, transport ‚Äî the basics to keep going</p>
        </div>

        <!-- New: Are you saving each month? -->
        <div class="form-group">
          <label>Are you saving money each month?</label>
          <div style="display: flex; gap: 1rem;">
            <label style="display: flex; align-items: center; cursor: pointer;">
              <input type="radio" name="saving-monthly" id="saving-yes" value="yes" style="margin-right: 0.5rem;">
              Yes
            </label>
            <label style="display: flex; align-items: center; cursor: pointer;">
              <input type="radio" name="saving-monthly" id="saving-no" value="no" style="margin-right: 0.5rem;">
              No
            </label>
          </div>
        </div>

        <div class="form-group">
          <label>After all expenses, do you typically have money left over each month?</label>
          <select id="monthly-surplus">
            <option value="">Select...</option>
            <option value="surplus">Yes, I regularly save</option>
            <option value="breakeven">I roughly break even</option>
            <option value="occasional">Occasionally use credit</option>
            <option value="reliant">Reliant on credit</option>
          </select>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 1rem;">
          <button class="btn btn--secondary" style="flex: 1;" onclick="nextStep(2)">Back</button>
          <button class="btn btn--primary" style="flex: 1;" onclick="nextStep(4)">Continue ‚Üí</button>
        </div>
      </div>
      
      <!-- Step 4 -->
      <div class="wellness-step" id="step-4" style="display: none;">
        <h3 style="margin-bottom: 1.5rem;">Protection</h3>

        <h4 style="font-size: 1rem; margin-bottom: 1rem; color: var(--text-secondary);">Employer Benefits</h4>

        <!-- New: Employer sick pay -->
        <div class="form-group">
          <label>Does your employer pay sick pay above the statutory minimum?</label>
          <select id="employer-sick-pay" onchange="toggleSickPayDuration()">
            <option value="">Select...</option>
            <option value="yes">Yes</option>
            <option value="no">No</option>
            <option value="not-sure">Not sure</option>
          </select>
        </div>

        <!-- Conditional: Sick pay duration -->
        <div class="form-group" id="sick-pay-duration-group" style="display: none;">
          <label>If yes: Full pay for how long?</label>
          <select id="sick-pay-duration">
            <option value="">Select...</option>
            <option value="1">1 month</option>
            <option value="2">2 months</option>
            <option value="3">3 months</option>
            <option value="6">6+ months</option>
            <option value="dont-know">Don't know</option>
          </select>
        </div>

        <!-- New: Death in Service -->
        <div class="form-group">
          <label>Does your employer provide Death in Service benefit?</label>
          <select id="employer-death-in-service" onchange="toggleDeathInServiceMultiple()">
            <option value="">Select...</option>
            <option value="yes">Yes</option>
            <option value="no">No</option>
            <option value="not-sure">Not sure</option>
          </select>
        </div>

        <!-- Conditional: Death in Service multiple -->
        <div class="form-group" id="death-in-service-multiple-group" style="display: none;">
          <label>Multiple of salary</label>
          <select id="death-in-service-multiple">
            <option value="">Select...</option>
            <option value="1">1x annual salary</option>
            <option value="2">2x annual salary</option>
            <option value="3">3x annual salary</option>
            <option value="4">4x annual salary</option>
            <option value="other">Other/Don't know</option>
          </select>
        </div>

        <h4 style="font-size: 1rem; margin: 1.5rem 0 1rem; color: var(--text-secondary);">Personal Protection</h4>

        <div class="form-group">
          <label>Do you have life insurance?</label>
          <select id="life-insurance">
            <option value="">Select...</option>
            <option value="full">Yes, adequate cover</option>
            <option value="partial">Some, but may not be enough</option>
            <option value="none">No</option>
          </select>
        </div>
        <div class="form-group">
          <label>Do you have income protection insurance?</label>
          <select id="income-protection" onchange="toggleIPDetails()">
            <option value="">Select...</option>
            <option value="full">Yes</option>
            <option value="partial">Partial/through employer only</option>
            <option value="none">No</option>
          </select>
        </div>

        <!-- Conditional: IP Details -->
        <div id="ip-details-group" style="display: none; background: #F8FAFC; padding: 1rem; border-radius: var(--radius-md); margin-bottom: 1rem;">
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 1rem; font-weight: 600;">Income Protection Details</p>

          <div class="form-group">
            <label>Monthly benefit amount (¬£)</label>
            <input type="number" id="ip-monthly-benefit" placeholder="e.g. 2000" min="0" step="100">
          </div>

          <div class="form-group">
            <label>Deferred period (how long before benefit starts?)</label>
            <select id="ip-deferred-period">
              <option value="">Select...</option>
              <option value="1">1 month</option>
              <option value="2">2 months</option>
              <option value="3">3 months</option>
              <option value="6">6 months</option>
              <option value="12">12 months</option>
            </select>
          </div>

          <div class="form-group">
            <label>Benefit period (how long does it pay?)</label>
            <select id="ip-benefit-period">
              <option value="">Select...</option>
              <option value="1">1 year</option>
              <option value="2">2 years</option>
              <option value="5">5 years</option>
              <option value="retirement">Until retirement (age 65)</option>
              <option value="lifetime">Lifetime</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label>Do you have critical illness cover?</label>
          <select id="critical-illness">
            <option value="">Select...</option>
            <option value="full">Yes</option>
            <option value="partial">Partial</option>
            <option value="none">No</option>
          </select>
        </div>

        <!-- Optional Email Capture -->
        <div class="form-group" style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--medium-grey);">
          <label>Email (Optional) - Receive your report and occasional mortgage tips</label>
          <input type="email" id="user-email" placeholder="your.email@example.com" style="padding: 0.75rem; border: 1px solid var(--medium-grey); border-radius: var(--radius-md); width: 100%; font-size: 1rem;">
          <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem;">
            We respect your privacy. By providing your email, you consent to receive your wellness report and occasional helpful mortgage information. You can unsubscribe anytime. See our <a href="/privacy/" style="color: var(--brand-orange);">privacy policy</a>.
          </p>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 1rem;">
          <button class="btn btn--secondary" style="flex: 1;" onclick="nextStep(3)">Back</button>
          <button class="btn btn--primary" style="flex: 1;" onclick="nextStep(5)">Continue ‚Üí</button>
        </div>
      </div>

      <!-- Step 5: Perception Check -->
      <div class="wellness-step" id="step-5" style="display: none;">
        <h3 style="margin-bottom: 1.5rem;">One Last Thing...</h3>
        <p style="margin-bottom: 2rem; color: var(--text-secondary);">Before we crunch the numbers, we'd like to know what you <em>think</em>.</p>

        <div class="form-group">
          <label>If you or your partner couldn't work from tomorrow, how many months do you think your savings could cover your mortgage/rent and essential bills?</label>
          <div style="margin: 1.5rem 0;">
            <input type="range" id="perception-months" min="0" max="24" value="3" step="1" style="width: 100%;" oninput="updatePerceptionValue(this.value)">
            <div style="display: flex; justify-content: space-between; font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
              <span>0 months</span>
              <span id="perception-value" style="font-weight: 600; color: var(--brand-orange);">3 months</span>
              <span>24 months</span>
            </div>
          </div>
        </div>

        <div style="background: var(--cream); padding: 1.5rem; border-radius: var(--radius-lg); margin-top: 2rem;">
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin: 0;">
            üí° <strong>Why we ask:</strong> This helps us show you how your perception compares to reality ‚Äî many people are surprised by the gap.
          </p>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
          <button class="btn btn--secondary" style="flex: 1;" onclick="nextStep(4)">Back</button>
          <button class="btn btn--primary" style="flex: 1;" onclick="calculateScore()">Get My Score ‚úì</button>
        </div>
      </div>

      <!-- Results -->
      <div class="wellness-step" id="results" style="display: none;">

        <!-- NEW: Financial Runway Callout (Hero Metric) -->
        <div id="runway-callout" style="background: linear-gradient(135deg, var(--brand-orange) 0%, #D94A1F 100%); color: white; padding: 2rem; border-radius: var(--radius-lg); margin-bottom: 2rem; text-align: center;">
          <p style="font-size: 0.875rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; opacity: 0.9; margin-bottom: 0.5rem;">Your Financial Runway</p>
          <div style="margin: 1.5rem 0;">
            <span id="runway-days" style="font-family: var(--font-display); font-size: 4rem; font-weight: 700; line-height: 1;">0</span>
            <span style="font-size: 1.25rem; opacity: 0.9;"> days</span>
          </div>
          <p id="runway-message" style="font-size: 1.1rem; margin-bottom: 1rem; opacity: 0.95;">If your income stopped tomorrow, your savings would cover essential expenses for approximately X days.</p>
          <div id="runway-comparison" style="display: flex; justify-content: center; gap: 2rem; font-size: 0.875rem; opacity: 0.9; flex-wrap: wrap;">
            <span>UK average: <strong>19 days</strong></span>
            <span>Target: <strong>90 days</strong></span>
          </div>
        </div>

        <div style="text-align: center; padding: 2rem 0;">
          <p style="font-size: 0.875rem; font-weight: 600; color: var(--brand-orange); margin-bottom: 1rem;">Your Mortgage Readiness Score</p>
          <div style="position: relative; width: 200px; height: 120px; margin: 0 auto;">
            <svg viewBox="0 0 200 120" style="width: 100%; height: 100%;">
              <defs>
                <linearGradient id="scoreGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" style="stop-color:#EF4444"/>
                  <stop offset="25%" style="stop-color:#F97316"/>
                  <stop offset="50%" style="stop-color:#EAB308"/>
                  <stop offset="75%" style="stop-color:#84CC16"/>
                  <stop offset="100%" style="stop-color:#22C55E"/>
                </linearGradient>
              </defs>
              <path d="M 20 100 A 80 80 0 0 1 180 100" fill="none" stroke="#e5e5e5" stroke-width="12" stroke-linecap="round"/>
              <path d="M 20 100 A 80 80 0 0 1 180 100" fill="none" stroke="url(#scoreGradient)" stroke-width="12" stroke-linecap="round" stroke-dasharray="251" stroke-dashoffset="251" id="score-arc"/>
            </svg>
            <div style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); text-align: center;">
              <span id="score-value" style="font-family: var(--font-display); font-size: 3rem; color: var(--brand-charcoal);">0</span>
              <span style="font-size: 1rem; color: var(--text-secondary);">/100</span>
            </div>
          </div>
          <div id="score-label" style="margin-top: 1rem;"></div>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 2rem 0; padding: 1.5rem; background: var(--cream); border-radius: var(--radius-lg);">
          <div>
            <p style="font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: #22C55E; margin-bottom: 0.5rem;">‚úì Strengths</p>
            <ul id="strengths-list" style="list-style: none; font-size: 0.9rem;"></ul>
          </div>
          <div>
            <p style="font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: var(--brand-orange); margin-bottom: 0.5rem;">‚ö† Areas to Improve</p>
            <ul id="improve-list" style="list-style: none; font-size: 0.9rem;"></ul>
          </div>
        </div>

        <!-- Visualizations -->
        <div style="margin: 2rem 0;">
          <h3 style="text-align: center; margin-bottom: 1.5rem;">Detailed Breakdown</h3>
          <div class="wellness-charts-grid">
            <div class="wellness-chart-card">
              <h4 style="text-align: center; margin-bottom: 1rem; font-size: 0.9rem; color: var(--text-secondary);">Four Pillar Analysis</h4>
              <canvas id="radar-chart" style="max-height: 300px;"></canvas>
            </div>
            <div class="wellness-chart-card">
              <h4 style="text-align: center; margin-bottom: 1rem; font-size: 0.9rem; color: var(--text-secondary);">Category Scores</h4>
              <canvas id="bar-chart" style="max-height: 300px;"></canvas>
            </div>
          </div>
        </div>

        <!-- NEW: Perception Gap -->
        <div id="perception-gap-section" style="background: var(--cream); padding: 2rem; border-radius: var(--radius-lg); margin: 2rem 0;">
          <h3 style="text-align: center; margin-bottom: 1.5rem;">Reality Check</h3>
          <div style="max-width: 600px; margin: 0 auto;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 1.5rem;">
              <div style="text-align: center; padding: 1.5rem; background: white; border-radius: var(--radius-md);">
                <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">You Estimated</p>
                <p id="perception-estimated" style="font-family: var(--font-display); font-size: 2.5rem; color: var(--brand-charcoal); margin: 0;">0</p>
                <p style="font-size: 0.875rem; color: var(--text-secondary);">days</p>
              </div>
              <div style="text-align: center; padding: 1.5rem; background: white; border-radius: var(--radius-md); border: 2px solid var(--brand-orange);">
                <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">The Reality</p>
                <p id="perception-actual" style="font-family: var(--font-display); font-size: 2.5rem; color: var(--brand-orange); margin: 0;">0</p>
                <p style="font-size: 0.875rem; color: var(--text-secondary);">days</p>
              </div>
            </div>
            <p id="perception-message" style="text-align: center; font-size: 1rem; color: var(--text-secondary);"></p>
          </div>
        </div>

        <!-- NEW: Income Waterfall Chart -->
        <div style="background: white; padding: 2rem; border-radius: var(--radius-lg); box-shadow: 0 2px 8px rgba(0,0,0,0.05); margin: 2rem 0;">
          <h3 style="text-align: center; margin-bottom: 1rem;">What If You Couldn't Work?</h3>
          <p style="text-align: center; color: var(--text-secondary); margin-bottom: 2rem;">Your income over 6 months if you were unable to work due to illness or injury</p>
          <canvas id="waterfall-chart" style="max-height: 400px;"></canvas>
          <div id="benefit-explanation" style="display: none; margin-top: 1.5rem; padding: 1rem 1.25rem; background: #F0F4FF; border-left: 3px solid #3B82F6; border-radius: 0 8px 8px 0;"></div>
        </div>

        <!-- NEW: Risk Probability Cards -->
        <div style="margin: 2rem 0;">
          <h3 style="text-align: center; margin-bottom: 1rem;">Mortgage Term Risk Statistics</h3>
          <p style="text-align: center; color: var(--text-secondary); margin-bottom: 2rem;">During a typical 25-year mortgage, based on your age and profile:</p>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem;">
            <div id="risk-death" style="background: white; padding: 1.5rem; border-radius: var(--radius-lg); box-shadow: 0 2px 8px rgba(0,0,0,0.05); text-align: center;">
              <p style="font-family: var(--font-display); font-size: 2.5rem; color: var(--brand-orange); margin: 0;">0%</p>
              <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">Chance of death</p>
            </div>
            <div id="risk-ci" style="background: white; padding: 1.5rem; border-radius: var(--radius-lg); box-shadow: 0 2px 8px rgba(0,0,0,0.05); text-align: center;">
              <p style="font-family: var(--font-display); font-size: 2.5rem; color: var(--brand-orange); margin: 0;">0%</p>
              <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">Chance of critical illness</p>
            </div>
            <div id="risk-absence" style="background: white; padding: 1.5rem; border-radius: var(--radius-lg); box-shadow: 0 2px 8px rgba(0,0,0,0.05); text-align: center;">
              <p style="font-family: var(--font-display); font-size: 2.5rem; color: var(--brand-orange); margin: 0;">0%</p>
              <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">Chance of 2+ month absence</p>
            </div>
          </div>
          <p style="text-align: center; font-size: 0.8rem; color: var(--text-secondary); margin-top: 1.5rem;">These are statistical averages and should be discussed with an adviser. Individual circumstances vary.</p>
        </div>

        <!-- Share & Download Actions -->
        <div id="report-actions" style="text-align: center; margin: 2rem 0; padding: 1.5rem; background: var(--cream); border-radius: var(--radius-lg);">
          <p style="font-size: 0.9rem; margin-bottom: 1rem;">Share your results or download a detailed report</p>
          <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
            <button id="share-report-btn" class="btn btn--secondary" style="display: none;">
              üìã Share Report Link
            </button>
            <button id="download-pdf-btn" class="btn btn--secondary" style="display: none;">
              üìÑ Download PDF Report
            </button>
          </div>
          <div id="loading-indicator" style="display: none; margin-top: 1rem;">
            <p style="color: var(--brand-orange);">‚è≥ Processing...</p>
          </div>
        </div>

        <div style="text-align: center; padding-top: 1.5rem; border-top: 1px solid var(--medium-grey);">
          <p style="margin-bottom: 1rem;">Want to discuss your results with an expert?</p>
          <a href="/contact/" class="btn btn--primary">Book a Free Consultation ‚Üí</a>
          <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 1rem;">This assessment is indicative only and does not guarantee mortgage acceptance.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- For Employers CTA -->
<section class="section--charcoal">
  <div class="container container--narrow text-center">
    <h2>Offer This to Your Employees</h2>
    <p style="font-size: 1.1rem;">Provide your workforce with access to our Financial Wellness Check as part of your employee benefits package ‚Äî at zero cost to your organisation.</p>
    <div style="margin-top: 2rem;">
      <a href="/employers/" class="btn btn--white btn--large">Learn About Employer Partnerships</a>
    </div>
  </div>
</section>

<style>
.step-dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: var(--medium-grey);
  transition: all 0.3s ease;
}
.step-dot--active {
  background: var(--brand-orange);
  transform: scale(1.2);
}
.wellness-step {
  animation: fadeIn 0.4s ease;
}
</style>

{{ end }}

{{ define "scripts" }}
<!-- Chart.js for visualizations -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7"></script>
<!-- Wellness Check Client -->
<script src="/js/wellness-client.js"></script>
{{ end }}
